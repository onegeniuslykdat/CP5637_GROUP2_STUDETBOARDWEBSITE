/**
 * This JS file was auto-generated via Terser.
 *
 * Contributors should avoid editing this file, but instead edit the associated
 * non minified file file. For more information, check out our engineering docs
 * on how we handle JS minification in our engineering docs.
 *
 * @see: https://evnt.is/dev-docs-minification
 */

var tribe_event_tickets_attendees=tribe_event_tickets_attendees||{};!function($,obj){obj.count_columns=function($row){var count=0,$cells=$row.find("td, th");return $cells.length?($cells.each((function(){var colspan=parseInt($(this).attr("colspan"),10);count+=1+(colspan=colspan>1?colspan-1:0)})),count):0},obj.remove_tickets=function(ticket_ids){$("#the-list").find("tr").each((function(){var $this=$(this),ticket_ref=$this.find(".check-column").find("input").val();if("string"==typeof ticket_ref){var match_id=ticket_ref.match(/^[0-9]+/);match_id.length&&-1!==ticket_ids.indexOf(parseInt(match_id[0],10))&&$this.remove()}}))},$((function init(){if("undefined"!=typeof AttendeesPointer&&AttendeesPointer.length){options=$.extend(AttendeesPointer.options,{close:function(){$.post(Attendees.ajaxurl,{pointer:AttendeesPointer.pointer_id,action:"dismiss-wp-pointer"})},open:function(event,widget){widget.pointer.css({top:parseInt(widget.pointer.css("top").replace("px",""),10)+5}).find(".wp-pointer-arrow").css({right:"50px",left:"auto"}),widget.element.on({click:function(){widget.element.pointer("close")}})}});$(AttendeesPointer.target).pointer(options).pointer("open").pointer("widget")}function create_move_ticket_modal(ticket_ids,eventId=null){$.isArray(ticket_ids)||(ticket_ids=[ticket_ids]);var target_width=parseInt(.7*$(window).width(),10);target_width=target_width>800?800:target_width;var target_height=parseInt(.9*$(window).height(),10);target_height=target_height>800?800:target_height;let params="&ticket_ids="+ticket_ids.join("|")+"&width="+target_width+"&height="+target_height;if(eventId)params+="&event_id="+eventId;else if(!Attendees.move_url.includes("event_id"))return;const requestUrl=Attendees.move_url.replace("&TB_",params+"&TB_");tb_show(null,requestUrl,!1)}var $show_links,$hide_links;$("input.print").on("click",(function(){$(window).trigger("attendees-report-before-print.tribe-tickets");var $table=$("table.wp-list-table.attendees"),$visible_columns=$table.find("thead th:visible").length,$header_and_data=$table.find("th,td");$header_and_data.css({width:100/($visible_columns-3)+"%"}),window.print(),$header_and_data.css({width:""}),$(window).trigger("attendees-report-after-print.tribe-tickets")})),$(".tribe-attendees-email").on({submit:function(event){$(".tribe-attendees-email").hide(),$(document.getElementById("tribe-loading")).show()}}),$("span.trash a").on("click",(function(e){const ticketType=$(this).closest("tr").data("ticket-type");let confirmationMessage=Attendees.confirmation_singular;return Attendees.confirmation&&Attendees.confirmation[ticketType]&&Attendees.confirmation[ticketType].singular&&(confirmationMessage=Attendees.confirmation[ticketType].singular||confirmationMessage),confirm(confirmationMessage)})),$(".event-tickets__attendees-admin-form").on("submit",(function(e){if("delete_attendee"!==$("#bulk-action-selector-top").val())return;if(!$(this).serialize().includes("&attendee"))return;const selectedAttendees=this.querySelectorAll('tr:has(input[name="attendee[]"]:checked)'),ticketTypes=Array.from(selectedAttendees).map((attendee=>attendee.dataset.ticketType)),multipleTicketTypes=new Set(ticketTypes).size>1,multipleAttendees=selectedAttendees.length>1,ticketType=ticketTypes[0];let confirmationMessage=multipleAttendees?Attendees.confirmation_plural:Attendees.confirmation_singular;return!multipleTicketTypes&&Attendees.confirmation&&Attendees.confirmation[ticketType]&&(confirmationMessage=multipleAttendees?Attendees.confirmation[ticketType].plural||confirmationMessage:Attendees.confirmation[ticketType].singular||confirmationMessage),confirm(confirmationMessage)})),$(".tickets_checkin").on("click",(function(e){var obj=jQuery(this);obj.prop("disabled",!0),obj.addClass("is-busy");var params={action:"tribe-ticket-checkin",provider:obj.attr("data-provider"),attendee_id:obj.attr("data-attendee-id"),nonce:Attendees.checkin_nonce};obj.attr("data-event-id")&&(params.event_ID=obj.attr("data-event-id")),$.post(Attendees.ajaxurl,params,(function(response){if(response.success){obj.closest("tr").addClass("tickets_checked");var total_attendees=parseInt($("#percent_checkedin").data("total-attendees")),total_checked_in=parseInt($("#total_checkedin").text())+1,percent_checked_in=Math.round(total_checked_in/total_attendees*100).toString()+"%";$("#total_checkedin").text(total_checked_in),$("#percent_checkedin").text(percent_checked_in),response?.data?.reload&&window.location.reload()}obj.prop("disabled",!1),obj.removeClass("is-busy")}),"json"),e.preventDefault()})),$(".tickets_uncheckin").on("click",(function(e){var obj=jQuery(this);obj.prop("disabled",!0),obj.addClass("is-busy");var params={action:"tribe-ticket-uncheckin",provider:obj.attr("data-provider"),attendee_id:obj.attr("data-attendee-id"),nonce:Attendees.uncheckin_nonce};obj.attr("data-event-id")&&(params.event_ID=obj.attr("data-event-id")),$.post(Attendees.ajaxurl,params,(function(response){response.success&&(obj.closest("tr").removeClass("tickets_checked"),$("#total_checkedin").text(parseInt($("#total_checkedin").text())-1),response?.data?.reload&&window.location.reload()),obj.prop("disabled",!1),obj.removeClass("is-busy")}),"json"),e.preventDefault()})),$("table.wp-list-table").on("click",".row-actions .move-ticket",(function(event){const ticketId=$(this).data("attendee-id"),eventId=$(this).data("event-id");return ticketId&&create_move_ticket_modal(ticketId,eventId),event.stopPropagation(),!1})),$("#doaction, #doaction2").on("click",(function(event){var bulk_action_selector;switch($(event.currentTarget).attr("id")){case"doaction":bulk_action_selector="action";break;case"doaction2":bulk_action_selector="action2"}if(void 0!==bulk_action_selector&&"move"===$('select[name="'+bulk_action_selector+'"]').val()){var $checked_tickets=jQuery('input[name="attendee[]"]:checked');if($checked_tickets.length){var ticket_list=[];$checked_tickets.each((function(){var ticket_id=$(this).val().match(/^[0-9]+/);ticket_id&&ticket_list.push(ticket_id.toString())})),create_move_ticket_modal(ticket_list)}else alert(Attendees.cannot_move);return event.stopPropagation(),!1}})),$show_links=$(".ticket-history"),($hide_links=$(".hide-ticket-history")).hide(),$show_links.on("click",(function(event){var $this=$(this),$hide_link=$this.siblings(".hide-ticket-history"),ticket_id=parseInt($this.data("ticket-id"),10),check=$this.data("check");if(ticket_id&&check){var $existing_row=$(document.getElementById("ticket-history-"+ticket_id));return $existing_row.length?($existing_row.show(),$this.hide(),$hide_link.show()):function load_history_row(){var request={action:"get_ticket_history",check:check,ticket_id:ticket_id};$.post(Attendees.ajaxurl,request,(function(response){if(void 0!==response.data&&"string"==typeof response.data.html){var $parent_row=$this.parents("tr"),num_cols=obj.count_columns($parent_row);$('<tr id="ticket-history-'+ticket_id+'"> <td colspan="'+num_cols+'">'+response.data.html+"</td></tr>").hide().insertAfter($parent_row).slideDown(),$this.hide(),$hide_link.show()}}))}(),event.stopPropagation(),!1}})),$hide_links.on("click",(function(event){var $this=$(this),$show_link=$this.siblings(".ticket-history"),ticket_id=parseInt($show_link.data("ticket-id"),10);$(document.getElementById("ticket-history-"+ticket_id)).hide(),$show_link.show(),$this.hide()}))}))}(jQuery,tribe_event_tickets_attendees);
/**
 * This JS file was auto-generated via Terser.
 *
 * Contributors should avoid editing this file, but instead edit the associated
 * non minified file file. For more information, check out our engineering docs
 * on how we handle JS minification in our engineering docs.
 *
 * @see: https://evnt.is/dev-docs-minification
 */

tribe.tickets=tribe.tickets||{},tribe.tickets.block={num_attendees:0,event:{}},function($,obj){const $document=$(document);obj.selectors={container:".tribe-tickets__tickets-wrapper",form:".tribe-tickets__tickets-form",blockFooter:".tribe-tickets__tickets-footer",blockFooterActive:"tribe-tickets__tickets-footer--active",blockFooterAmount:".tribe-amount",blockFooterQuantity:".tribe-tickets__tickets-footer-quantity-number",blockSubmit:"#tribe-tickets__tickets-submit",item:".tribe-tickets__tickets-item",itemDescription:".tribe-tickets__tickets-item-details-content",itemDescriptionButtonMore:".tribe-tickets__tickets-item-details-summary-button--more",itemDescriptionButtonLess:".tribe-tickets__tickets-item-details-summary-button--less",itemExtraAvailable:".tribe-tickets__tickets-item-extra-available",itemExtraAvailableQuantity:".tribe-tickets__tickets-item-extra-available-quantity",itemOptOut:".tribe-tickets-attendees-list-optout--wrapper",itemOptOutInput:"#tribe-tickets-attendees-list-optout-",itemPrice:".tribe-tickets__tickets-sale-price .tribe-amount",itemQuantity:".tribe-tickets__tickets-item-quantity",itemQuantityInput:".tribe-tickets__tickets-item-quantity-number-input",itemQuantityAdd:".tribe-tickets__tickets-item-quantity-add",itemQuantityRemove:".tribe-tickets__tickets-item-quantity-remove",submit:".tribe-tickets__tickets-buy",hiddenElement:".tribe-common-a11y-hidden"},obj.commerceSelector={edd:"Tribe__Tickets_Plus__Commerce__EDD__Main",rsvp:"Tribe__Tickets__RSVP",tpp:"Tribe__Tickets__Commerce__PayPal__Main",Tribe__Tickets__Commerce__PayPal__Main:"tribe-commerce",Tribe__Tickets__RSVP:"rsvp",Tribe__Tickets_Plus__Commerce__EDD__Main:"edd",Tribe__Tickets_Plus__Commerce__WooCommerce__Main:"woo",tribe_eddticket:"Tribe__Tickets_Plus__Commerce__EDD__Main",tribe_tpp_attendees:"Tribe__Tickets__Commerce__PayPal__Main",tribe_wooticket:"Tribe__Tickets_Plus__Commerce__WooCommerce__Main",woo:"Tribe__Tickets_Plus__Commerce__WooCommerce__Main"},obj.updateAvailability=function(tickets){Object.keys(tickets).forEach((function(ticketId){const available=tickets[ticketId].available,maxPurchase=tickets[ticketId].max_purchase,$ticketEl=$(obj.selectors.item+'[data-ticket-id="'+ticketId+'"]');if(0===available){const unavailableHtml=tickets[ticketId].unavailable_html;$ticketEl.prop("available",!1),$ticketEl.removeClass("instock"),$ticketEl.removeClass("purchasable"),$ticketEl.find(obj.selectors.itemQuantity).html(unavailableHtml),$ticketEl.find(obj.selectors.itemExtraAvailable).html("")}1<available&&($ticketEl.find(obj.selectors.itemQuantityInput).attr({max:maxPurchase}),$ticketEl.find(obj.selectors.itemExtraAvailableQuantity).html(available))}))},obj.updateFooter=function($form){const $footer=$form.find(obj.selectors.blockFooter);obj.updateFooterCount($form),obj.updateFooterAmount($form),$footer.addClass(obj.selectors.blockFooterActive.className())},obj.updateFooterCount=function($form){const $field=$form.find(obj.selectors.blockFooter+" "+obj.selectors.blockFooterQuantity),$quantities=$form.find(obj.selectors.item+" "+obj.selectors.itemQuantityInput);let footerCount=0;$quantities.each((function(){const $input=$(this);if(!$input.is(":visible"))return;let newQuantity=parseInt($input.val(),10);newQuantity=isNaN(newQuantity)?0:newQuantity,footerCount+=newQuantity}));const disabled=0>=footerCount;tribe.tickets.utils.disable($form.find(obj.selectors.submit),disabled),0>footerCount||$field.text(footerCount)},obj.getTicketsBlockProvider=function($form){return $form.data("provider")},obj.updateFooterAmount=function($form){const $field=$form.find(obj.selectors.blockFooter+" "+obj.selectors.blockFooterAmount),$quantities=$form.find(obj.selectors.item+" "+obj.selectors.itemQuantityInput),provider=obj.getTicketsBlockProvider($form);let footerAmount=0;$quantities.each((function(){const $input=$(this);if(!$input.is(":visible"))return;let quantity=parseInt($input.val(),10);quantity=isNaN(quantity)?0:quantity;const $ticketItem=$input.closest(obj.selectors.item),ticketPrice=obj.getPrice($ticketItem,provider);footerAmount+=ticketPrice*quantity})),0>footerAmount||$field.text(tribe.tickets.utils.numberFormat(footerAmount,provider))},obj.updateFormTotals=function($form){$document.trigger("beforeUpdateFormTotals.tribeTicketsBlock",[$form]),obj.updateFooter($form),$document.trigger("afterUpdateFormTotals.tribeTicketsBlock",[$form])},obj.getTickets=function(){return $(obj.selectors.item).map((function(){return $(this).data("ticket-id")})).get()},obj.maybeShowOptOut=function($ticket,newQuantity){if($ticket.has(obj.selectors.itemOptOut).length){const $item=$ticket.closest(obj.selectors.item);0<newQuantity?$item.addClass("show-optout"):$item.removeClass("show-optout")}},obj.formMatch=function($input,newValue){const formID=$input.closest(obj.selectors.item).attr("data-ticket-id"),$formTicket=$('[ data-ticket-id="'+formID+'" ]');$formTicket.length>=2&&$formTicket.each((function(){$(this).find(obj.selectors.itemQuantityInput).val(newValue),obj.updateFooter($(this).closest("form"))}))},obj.stepUp=function($input,originalValue){const max=$input.attr("max")?Number($input.attr("max")):-1,step=$input.attr("step")?Number($input.attr("step")):1;let newValue=-1===max||max>=originalValue+step?originalValue+step:max;const $parent=$input.closest(obj.selectors.item);if("true"===$parent.attr("data-has-shared-cap")){const $form=$parent.closest("form");newValue=obj.checkSharedCapacity($form,newValue,$parent)}if(0!==newValue)if(0>newValue)$input[0].value=originalValue+newValue;else{if("function"==typeof $input[0].stepUp)try{if(max<originalValue+step)return;$input[0].stepUp()}catch(ex){$input.val(newValue)}else $input.val(newValue);obj.formMatch($input,newValue)}},obj.stepDown=function($input,originalValue){const min=$input.attr("min")?Number($input.attr("min")):0,step=$input.attr("step")?Number($input.attr("step")):1,decrease=min<=originalValue-step&&0<originalValue-step?originalValue-step:min;if("function"==typeof $input[0].stepDown)try{$input[0].stepDown()}catch(ex){$input[0].value=decrease}else $input[0].value=decrease;obj.formMatch($input,decrease)},obj.checkAvailability=function(){const params={action:"ticket_availability_check",tickets:obj.getTickets()};$.post(TribeTicketOptions.ajaxurl,params,(function(response){if(!response.success)return;const tickets=response.data.tickets;obj.updateAvailability(tickets)})),0<TribeTicketOptions.availability_check_interval&&setTimeout(obj.checkAvailability,TribeTicketOptions.availability_check_interval)},obj.checkSharedCapacity=function($form,qty,$target){let sharedCap=[],currentLoad=[];const $sharedTickets=$form.find(obj.selectors.item).filter('[data-has-shared-cap="true"]'),$sharedCapTickets=$sharedTickets.find(obj.selectors.itemQuantityInput);if(!$sharedTickets.length)return qty;const activeTicketLimit=$target.attr("data-available-count"),totalSharedCap=$target.attr("data-shared-cap");return void 0===activeTicketLimit||void 0===totalSharedCap?qty:($sharedCapTickets.each((function(){currentLoad.push(parseInt($(this).val(),10))})),currentLoad=currentLoad.reduce((function(a,b){return a+b}),0),$sharedTickets.each((function(){sharedCap.push(parseInt($(this).attr("data-available-count"),10))})),sharedCap=Math.max.apply(this,sharedCap),tribe.tickets.utils.calculateSharedCap(qty,activeTicketLimit,sharedCap,currentLoad))},obj.getQty=function($cartItem){const qty=parseInt($cartItem.find(obj.selectors.itemQuantityInput).val(),10);return isNaN(qty)?0:qty},obj.getPrice=function($item){return tribe.tickets.utils.getPrice($item,obj.tribe_tickets_provider)},obj.getTicketsForCart=function($form){const tickets=[];return($form||$document).find(obj.selectors.item).each((function(){const $row=$(this);if(!$row.is(":visible"))return;const ticketId=$row.data("ticketId"),qty=$row.find(obj.selectors.itemQuantityInput).val(),$optoutInput=$row.find('[name="attendee[optout]"]');let optout=$optoutInput.val();$optoutInput.is(":checkbox")&&(optout=$optoutInput.prop("checked")?1:0);const data={};data.ticket_id=ticketId,data.quantity=qty,data.optout=optout,tickets.push(data)})),tickets},obj.unbindTicketsAddRemove=function($container){$container.find(obj.selectors.itemQuantityAdd+", "+obj.selectors.itemQuantityRemove).off()},obj.bindTicketsAddRemove=function($container){$container.find(obj.selectors.itemQuantityAdd+", "+obj.selectors.itemQuantityRemove).unbind("click").on("click",(function(e){e.preventDefault();const $input=$(this).parent().find('input[type="number"]');if($document.trigger("beforeTicketsAddRemove.tribeTicketsBlock",[$input]),$input.is(":disabled"))return!1;const originalValue=Number($input[0].value);$(this).hasClass(obj.selectors.itemQuantityAdd.className())?obj.stepUp($input,originalValue):obj.stepDown($input,originalValue),originalValue!==$input[0].value&&$input.trigger("change"),$document.trigger("afterTicketsAddRemove.tribeTicketsBlock",[$input])}))},obj.unbindTicketsQuantityInput=function($container){$container.find(obj.selectors.itemQuantityInput).off()},obj.bindTicketsQuantityInput=function($container){const $quantityInput=$container.find(obj.selectors.itemQuantityInput);$quantityInput.on("keypress",(function(e){if(13===e.keyCode)return e.preventDefault(),void e.stopPropagation()})),$quantityInput.on("change keyup",(function(e){const $this=$(e.target);$document.trigger("beforeTicketsQuantityChange.tribeTicketsBlock",[$this]);const $ticket=$this.closest(obj.selectors.item),$form=$this.closest("form"),max=$this.attr("max");let maxQty=0,newQuantity=parseInt($this.val(),10);newQuantity=isNaN(newQuantity)?0:newQuantity,max<newQuantity&&(newQuantity=max,$this.val(max)),"true"===$ticket.attr("data-has-shared-cap")&&(maxQty=obj.checkSharedCapacity($form,newQuantity,$this)),0>maxQty&&(newQuantity+=maxQty,$this.val(newQuantity)),e.preventDefault(),obj.maybeShowOptOut($ticket,newQuantity),obj.updateFooter($form),obj.updateFormTotals($form),$document.trigger("afterTicketsQuantityChange.tribeTicketsBlock",[$this])}))},obj.itemDescriptionToggle=function(event){if("keyup"===event.type&&13!==event.keyCode)return;const trigger=event.target;if(!trigger)return;const $trigger=$(trigger);if(!$trigger.hasClass(obj.selectors.itemDescriptionButtonMore.className())&&!$trigger.hasClass(obj.selectors.itemDescriptionButtonLess.className()))return;const $parent=$trigger.closest(obj.selectors.item),$target=$("#"+$trigger.attr("aria-controls"));if(!$target.length||!$parent.length)return;const onOff=!$parent.hasClass("tribe__details--open");$parent.toggleClass("tribe__details--open",onOff),$target.toggleClass("tribe__details--open",onOff),$target.toggleClass(obj.selectors.hiddenElement.className())},obj.bindDescriptionToggle=function($container){const $descriptionToggleButtons=$container.find(obj.selectors.itemDescriptionButtonMore+", "+obj.selectors.itemDescriptionButtonLess);$descriptionToggleButtons.on("keyup",obj.itemDescriptionToggle),$descriptionToggleButtons.on("click",obj.itemDescriptionToggle)},obj.unbindDescriptionToggle=function($container){$container.find(obj.selectors.itemDescriptionButtonMore+", "+obj.selectors.itemDescriptionButtonLess).off()},obj.ticketsSubmit=function($form){const postId=$form.data("post-id"),ticketProvider=$form.data("provider");tribe.tickets.loader.show($form);const params={tribe_tickets_provider:obj.commerceSelector[ticketProvider],tribe_tickets_tickets:obj.getTicketsForCart($form),tribe_tickets_meta:{},tribe_tickets_post_id:postId};$form.find("#tribe_tickets_block_ar_data").val(JSON.stringify(params)),$document.trigger("beforeTicketsSubmit.tribeTicketsBlock",[$form,params]),$form.submit(),$document.trigger("afterTicketsSubmit.tribeTicketsBlock",[$form,params])},obj.bindTicketsSubmit=function($container){$container.find(obj.selectors.submit).on("click",(function(e){e.preventDefault();if(!!$(this).data("content"))return;const $form=$container.find(obj.selectors.form);obj.ticketsSubmit($form)}))},obj.bindEvents=function($container){$document.trigger("beforeSetup.tribeTicketsBlock",[$container]),tribe.tickets.utils.disable($container.find(obj.selectors.submit),!0),obj.bindTicketsAddRemove($container),obj.bindTicketsQuantityInput($container),obj.bindTicketsSubmit($container),obj.bindDescriptionToggle($container),$document.trigger("afterSetup.tribeTicketsBlock",[$container])},obj.ready=function(){0<TribeTicketOptions.availability_check_interval&&obj.checkAvailability();$document.find(obj.selectors.container).each((function(index,block){const $container=$(block);obj.bindEvents($container);const $form=$container.find(obj.selectors.form);obj.tribe_tickets_provider=$form.data("provider")}))},window.addEventListener("pageshow",(function(event){(event.persisted||void 0!==window.performance&&2===window.performance.navigation.type)&&obj.ready()})),$(obj.ready)}(jQuery,tribe.tickets.block);